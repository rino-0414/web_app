<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>タスク一覧</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            $('.task-title').click(function() {
                var taskId = $(this).data('id');
                var taskTitle = $(this).text();
                var taskDescription = $(this).data('description');
                var taskDueDate = $(this).data('due-date');
                
                $('#popup-title').text(taskTitle);
                $('#popup-description').text(taskDescription);
                $('#edit-task-button').data('id', taskId);
                $('#task-popup').show();
            });

            $('#popup-close').click(function() {
                $('#task-popup').hide();
            });

            $('#edit-task-button').click(function() {
                var taskId = $(this).data('id');
                window.location.href = '/edit_task/' + taskId;
            });
        });
    </script>
</head>
<body>
    <div class="container">
        <a href="{{ url_for('main.index') }}" class="back-button">×</a>
        <h1>タスク一覧</h1>
        <ul>
            {% for task in tasks %}
                <li>
                    <span class="task-title" data-id="{{ task[0] }}" data-description="{{ task[2] }}" data-due-date="{{ task[3] }}">{{ task[1] }}</span>
                    {% if task[3] < current_date %}
                        <span class="expired-date">{{ task[3] }} 期限切れ</span>
                    {% else %}
                        <span>{{ task[3] }}</span>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    </div>
    <div id="task-popup" style="display:none;">
        <h2 id="popup-title"></h2>
        <p id="popup-description"></p>
        <button id="edit-task-button">編集</button>
        <button id="popup-close">×</button>
    </div>
</body>
</html>